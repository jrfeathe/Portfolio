# Task 10a.REVOLT – Repository Audit & Pivot Snapshot

## Prompt (verbatim)
> Without existing context, scan the project and sumarize it in a detailed file. Save this file to the WBS folder. The point here is to pivot and change direction of the remainder of the project. Rather than be clouded by preimagined and preconceived ideas, we want to audit / assess what we currently have and plan finishing the project. The files for the WBS show the previous ideas for flow of the project, however many of these ideas were based on a vague seed idea. The project now feels close to its realized potential, and is a much finer example of the initial requirements than the contents of the WBS. Let's start with the detailed summary for now. Please audit and summarize the project. Also document this prompt in the file. This will be for commit "10a.REVOLT: Pivot. Plan project conclusion." which I am just beginning now (do not make the commit yourself).

## Repository Snapshot
- Monorepo (pnpm) anchored by Next.js 14 App Router app `apps/site`; shared `packages/ui` design system, `packages/config` tool presets, and a small `packages/cli` helper (`portfolio status`). Infra folder is placeholder-only.
- Project governance is documented (`CHARTER.md`, `SUCCESS_METRICS.md`, `RISK_LOG.md`), with completed WBS tasks logged through 10a.1. Essential WBS schema lives in `WBS/Essential_WBS.csv`; TODO backlog (`WBS/TODO.md`) lists remaining 10a.KING/10a.REVOLT items.
- Docs cover testing, dependency policy, performance (critical CSS/fonts, budgets), personalization brief (10a.0), content style, SEO structured data, media guidelines, contrast audit, resume publishing, and AI reference assets (`apps/site/data/ai/README.md`).

## Product Experience
- Routing & localization: middleware normalizes to `/[locale]` (default `en`), sets nonce + locale cookies, and applies CSP/security headers globally. Dictionaries provide EN/JA/ZH content; locale-aware metadata and breadcrumbs on all pages.
- Shell/layout: `ResponsiveShellLayout` with anchor nav, sticky CTA grid, skim-mode toggle, theme/contrast sliders, and chatbot inline card. `layout.tsx` bootstraps Ubuntu fonts, CSP nonces, theme/contrast init script, OTEL bootstrap, and chatbot provider.
- Home (`/[locale]`): Personalized hero copy from 10a.1, portrait placeholder media, tech stack carousel (logos in `apps/site/public/tech-stack`), proof chip grid (Rollodex, Quester2000, SER321 TA, Stellaris modding), roadmap list, sticky CTAs (resume download filename derived from resume version), skim mode via `?skim`, audio player, JSON-LD structured data, and OTEL web vitals hook.
- Experience (`/[locale]/experience`): Data-driven cards for engagements and tech-stack deep dives with anchor navigation. Uses dictionary-backed summaries/highlights.
- Meetings (`/[locale]/meetings`): Availability grid via `apps/site/data/availability/weekly.json`, slot blurbs, and contact mailto CTA; surfaced as sections inside shell layout. Redirect shim from `/meetings`.
- Notes (`/[locale]/notes` and dynamic slug): MDX pipeline with remark/rehype, code titles, TOC extraction, shared MDX components (diagrams, callouts, tables), slug validation, draft filtering, and JSON-LD for index/detail. Content currently limited (`content/notes/mdx-pipeline.mdx`).
- Resume: `content/resume.json` drives `/resume.json`, JSON-LD builders, and download links; PDFs live under `apps/site/public/` and `app/resume`.
- Media/performance: Self-hosted fonts, responsive image helper, critical CSS manifest (`app/critical-css.manifest.json`), inline CSS budget (16 KB), AVIF/WebP outputs, print stylesheet for recruiter exports.

## AI Assistant
- Frontend: `ChatbotProvider` with floating widget + inline card, session persistence, rate limit display, moderation handling, optional hCaptcha solve flow (script injected client-side), and reference links in replies.
- Backend: `/api/chat` (Node runtime) sanitizes input, caps history/length, rate-limits per IP/session, enforces professional-topic rules, optionally requires hCaptcha after two prompts, logs to `logs/chatbot/*.jsonl`. Retrieval uses local embeddings/anchors from `apps/site/data/ai/{chatbot-embeddings.json,tech-anchors.json}` with simple token scoring and bridge hints (e.g., Kubernetes adjacency). Model calls go to OpenRouter when `OPENROUTER_API_KEY` is set; replies are forced to use allowed links (anchors/resume), otherwise fall back to a canned professional response. PlantUML proxy API remains for MDX diagrams.

## Observability, Security, Performance
- OTEL: `instrumentation.ts` registers edge/server tracing; browser fetch + web vitals spans emit when OTLP env vars are set. Service names default to `portfolio-site`; env variable matrix documented in `README.md`.
- Security: Middleware generates per-request CSP nonce, sets strict CSP/security headers, and mirrors nonce to request/response headers for inline allowances. `public/.well-known/security.txt` and `public/pubkey.asc` publish disclosure contacts and PGP key. Chatbot redacts PII, blocks unprofessional topics, and limits allowed links.
- Performance: Budgets in `performance-budgets.json` enforced by `build:budgets` (bundle sizes, inline CSS, LCP/CLS). Critical CSS generated post-build via `scripts/performance/generate-critical-css.mjs`. Lighthouse CI scripts, bundle checks, and responsive media pipeline guard rail bloat.
- Accessibility: Design tokens include focus/contrast variants; global CSS honors reduced-motion/forced-colors. Jest-axe coverage for UI components; Playwright axe sweeps for core routes and preference toggles. High-contrast and theme toggles persist cookies and respect client hints.

## Testing, CI, and Tooling
- Tests: Jest unit/integration suite with ≥90% coverage gate (80% branches) and coverage reporter; component tests in `packages/ui` and `apps/site/src/components/__tests__`. Playwright specs cover skim mode, notes rendering, diagrams, downloads, structured data, and accessibility preferences/global axe. Structured-data tests validate JSON-LD outputs.
- CI/workflows: `.github/workflows/ci.yml` orchestrates typecheck → Jest → Playwright → Lighthouse; CodeQL scan present. Accessibility and performance guardrails documented in `docs/testing.md` and `docs/performance/*`.
- Tooling: Shared lint/prettier/TS/tailwind presets in `packages/config`; CLI utility (`packages/cli`) prints workspace overview. Renovate configured via `renovate.json` and dependency policy doc.

## Content & Data Sources
- Proof artifacts (`content/proof/*.md`) and skim matrix (`content/skim_matrix.csv`) feed recruiter flow. Tech stack and projects defined in `apps/site/data/{tech-stack-details.json,projects/*.json}` with draft/final variants. Availability schedule stored as JSON (12–22h visible most days; hidden hours list may be driving the reference-time bug noted in TODO).
- Market-facing positioning and tonal guidance live in `market-facing/positioning.md` and `docs/content-style-guide.md`; personalization brief (10a.0) and rewrites (10a.1) already applied to home dictionaries.

## Gaps, Risks, and Pivot Hooks
- Pending from `WBS/TODO.md`: availability reference/time display bug, localization polish, test/CI refresh, AudioPlayer QA + music track, SVG optimizations, high-contrast fixes, WBS refactor to drop obsolete ideas (e.g., PlantUML?) and re-align to current UX. KING items call for engineering notes rewrite, mobile view, Codex tech-stack callout, portrait asset, and AI assistant maturity.
- Content depth: only one MDX note and a handful of proof docs; some project/tech-stack entries still draft/placeholder (portrait placeholder, limited experience detail).
- Chatbot relies on external OpenRouter + hCaptcha; without keys it falls back to minimal replies. Logs write to `logs/chatbot`, which may need handling in deployment.
- Infra is stubbed; production deploy/collector wiring unspecified beyond README env notes.

## Suggested Focus for the Pivot/Conclusion
- Re-baseline WBS against the current app: prune outdated flows, lock the personalized home UX as canonical, and align remaining scope to experience/meetings/notes depth plus AI assistant polish.
- Close quality gaps before new features: fix availability bug, AudioPlayer reliability, high-contrast regressions, SVG bloat, and ensure tests/budgets reflect the personalized assets and tech stack carousel.
- Finish content runway: add finalized portrait and tech logos, expand notes/proof artifacts, complete experience/meetings copy for all locales, and verify resume versioning/downloads.
- Decide on AI posture: either ship with OpenRouter/hCaptcha configured or provide an explicit offline/FAQ fallback experience; update privacy/logging notices accordingly.
- Release readiness: rerun Lighthouse/axe/coverage after changes, update `COMPLETED_TASKS.md`, and capture remaining risks/metrics deltas before preparing the conclusion plan.

## ---Derived Plan Draft---
- There are multiple features still missing that are vital to the project. Based on the suggested focus, we should complete the loose ends before planning a conclusion.
- However, the loose ends are well known. We will simply plan which loose ends remain. We want to create a flow to eliminate any further feature creep. This project needs to be released.
- Based on the WBS, the features still incomplete are:

## Prompt (outstanding tasks request)
> I have added a new section to the document, so please recontextualize. WBS/Task_10a.REVOLT_Project_Audit.md:53 will be my human judgements based on your data outputs and my knowledge of the project. Using the files { WBS/Essential_WBS.csv , WBS/Epics.md , COMPLETED_TASKS.md } please try your best to find the tasks not completed and the planned features that are still missing. Document the tasks beneath WBS/Task_10a.REVOLT_Project_Audit.md:56 , and also document this prompt as well.

## Outstanding WBS tasks (not in `COMPLETED_TASKS.md`)
- Content & positioning: 1.1 Proof chips mapping; 1.2 Skim mode content matrix.
- Personalization: 10a.2 Visual theme refresh; 10a.3 Tech stack spotlight layout; 10a.KING freeform burst; 10a.REVOLT stabilization/cleanup (current pivot).
- Home & hook: 10b.0 Hero section & proof chips integration; 10b.1 Health tile integration.
- Skim mode: 11.0 Query param toggle & condensed layout; 11.1 Skim content renderer.
- Infra & hosting (edge): 12a.0 Hosting/runtime config; 12a.1 Custom domain & DNS; 12a.2 Edge ping service; 12a.3 Health/SLO tile component.
- Tor & privacy mirror: 12b.0 Tor mirror VPS; 12b.1 Tor HS config; 12b.2 Mirror security parity; 12b.3 NoScript fallback path.
- Engineering notes: 13.0 Notes list with filters/search/RSS; 13.1 Post template with trade-offs.
- Systems gallery: 14.0 ADR cards + detail pages; 14.1 Diagram pipeline security hardening.
- Micro-demos: 15.0 Demo framework; 15.1 Profiler panel; 15.2 Initial demos (virtualized list, debounce vs throttle).
- Reliability: 16.0 Public SLOs & error budget; 16.1 Incident playbook; 16.2 Mirror healthcheck.
- Changelog: 17.0 Semver release notes automation; 17.1 Roadmap board page.
- Contact: 18.0 Contact page; 18.1 Publishable CLI (`npx meet-...`) aligned to resume.json.
- Trade-off explorer: 19.0 Data model & scenarios; 19.1 Interactive UI.
- Perf badge: 20.0 Badge endpoint; 20.1 Badge widget.
- Headers: 21.0 /headers diagnostics page; 21.1 Onion-Location header.
- i18n: 22.0 Language switcher and complete second-language content coverage beyond baseline dictionaries.
- Analytics: 23.0 Cookieless analytics integration.
- Content backlog: 24.0 Three engineering notes; 24.1 Two systems diagrams; 24.2 PR review samples; 24.3 Incident templates.
- QA: 25.0 Cross-browser/device QA matrix; 25.1 Manual a11y audit pass.
- Launch: 26.0 SEO pass & sitemap; 26.1 Final perf hardening; 26.2 Announcement + backup test; 26.3 “Why an Onion Mirror” post.

## ---Derived Feature Judgements---
| Task                                                        | Notes                                                                                                                                                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1.1 Proof chips mapping                                     | We will not be mapping in our evidence as it poses a security risk. Recruiters can contact me for evidence.                                                                                                                                                                                                                                                                                                   |
| 1.2 Skim mode content matrix                                | TODO -> with modifications. Skim mode is not yet implemented. For skim mode we want to show experience, then the tech stack carousel. Hide intro message, image, roadmap, audio. Preserve nav, Need proof fast, AI Chatbot.                                                                                                                                                                                   |
| 10a.2 Visual theme refresh                                  | Mostly done. TODO. Fix high contrast. Fix Chatbot UI. Add self image. Verify Mobile UI with chatbot, skim mode, audio player.                                                                                                                                                                                                                                                                                 |
| 10a.3 Tech stack spotlight layout                           | 99% done. TODO. Fix mobile UI -> reduce columns to three for small screens.                                                                                                                                                                                                                                                                                                                                   |
| 10a.KING Freeform burst                                     | ???. Hopefully finished. We achieved our initial goal of knocking out major features and really transforming the project. This task was the most impactful and fun, yet caused high stress and feature creep.                                                                                                                                                                                                 |
| 10a.REVOLT Stabilization                                    | This document and future commits to return CI checks to normal. Draft a new version of Essential_WBS once this audit is completed. The major wars have been won; the king is growing old and tired. Time to revolt and return to stability, with the new WBS serving as the constitution. { I don't care if this is cringe, as this is my project. :) }                                                       |
| 10b.0 Hero section & proof chips integration                | Covered by other changes. Not needed.                                                                                                                                                                                                                                                                                                                                                                         |
| 10b.1 Health tile integration                               | DESIRED FEATURE. Optional. Place near end.                                                                                                                                                                                                                                                                                                                                                                    |
| 11.0 Skim query param + condensed layout                    | Refer to 1.2 Notes.                                                                                                                                                                                                                                                                                                                                                                                           |
| 11.1 Skim content renderer                                  | Refer to 1.2 Notes.                                                                                                                                                                                                                                                                                                                                                                                           |
| 12a.0 Hosting & runtime config                              | MAJOR TODO. Host the website. I believe we aren't using edge at the moment, so expect errors when trying to use it. Create stable build. Deploy on Oracle Cloud. Consider fallback host for if Oracle Cloud is down. Possibly Vercel free.                                                                                                                                                                    |
| 12a.1 Custom domain & DNS                                   | MAJOR TODO. Purchase domain and route to it appropriately.                                                                                                                                                                                                                                                                                                                                                    |
| 12a.2 Edge ping service                                     | TODO. Check the health of the site and document uptime.                                                                                                                                                                                                                                                                                                                                                       |
| 12a.3 Health/SLO tile component                             | TODO. Showcase the health.                                                                                                                                                                                                                                                                                                                                                                                    |
| 12b.0 Tor mirror VPS                                        | MODERATE/MAJOR TODO. Highly desired feature, but not essential. This epic as a whole is quite well designed however it must be established that we will mainly be focused on security, the NoScript version, and deployment with a jrfeathe...?????.onion address. Assume NoScript will be used, so we want that version to reflect high quality.                                                             |
| 12b.1 Tor HS config                                         | Refer to 12b.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                         |
| 12b.2 Mirror security parity                                | Refer to 12b.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                         |
| 12b.3 NoScript fallback                                     | Refer to 12b.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                         |
| 13.0 Notes list with filters/search/RSS                     | Todo. I don't think that anyone is actually going to read a page of random engineering notes about the website. This is a very over-complex way to document a changelog for the purposes we have here. I think a better format is to replace this notes page with a detailed writeup of my experience designing the website, the challenges faced, and how they were solved.                                  |
| 13.1 Post template with trade-offs                          | Refer to 13.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 14.0 ADR cards & detail pages                               | I don't see the point. Give me a good reason or delete.                                                                                                                                                                                                                                                                                                                                                       |
| 14.1 Diagram pipeline security                              | Refer to 14.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 15.0 Demo framework                                         | Not needed. If we want to wire in a demo later, I will just make a new page and add a link. We could possibly use a limited version of Quester2000 as our demo, but that isn't a priority now.                                                                                                                                                                                                                |
| 15.1 Profiler panel                                         | Refer to 15.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 15.2 Initial demos (virtualized list, debounce vs throttle) | Refer to 15.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 16.0 Public SLOs & error budget                             | This whole epic seems to follow the same train of thought as 12a.3, so it should probably be merged. We want to have empirical health data about the site and the mirror. We don't need too much for this. The focus shouldn't be here. It just might be nice to be able to see a small graph with an uptime percentage or something. Basic stats, likely shown at the bottom of Home unless skim mode is on. |
| 16.1 Incident playbook                                      | Refer to 16.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 16.2 Mirror healthcheck                                     | Refer to 16.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 17.0 Semver release notes automation                        | Not needed. The changelog is fine as a git tracked file.                                                                                                                                                                                                                                                                                                                                                      |
| 17.1 Roadmap board page                                     | Refer to 17.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 18.0 Contact page                                           | I don't think this is needed. I want an email. We can try to streamline the emailing process to reduce friction, maybe through a modal component. Put GitHub and LinkedIn in the site footer.                                                                                                                                                                                                                 |
| 18.1 Publishable CLI (`npx meet-...`)                       | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 19.0 Trade-off models & scenarios                           | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 19.1 Trade-off interactive UI                               | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 20.0 Perf badge endpoint                                    | Does this mean we essentially make an Android widget that calls our API for performance stats? This is a fun novelty and I guess I would use it, but nobody else would really care. Interesting idea actually, doesn't seem too hard. It would be nice to get pinged when the site is down but... Minimal priority.                                                                                           |
| 20.1 Perf badge widget                                      | Refer to 20.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 21.0 /headers diagnostics page                              | I don't see the point. Give me a good reason or delete.                                                                                                                                                                                                                                                                                                                                                       |
| 21.1 Onion-Location header                                  | Refer to 21.0 Notes.                                                                                                                                                                                                                                                                                                                                                                                          |
| 22.0 Language switcher & full second-language content       | MAJOR TODO. This is already set up. We just need to fill in the localizations and then go through them all for tone checks and correctness. I will need to bother my language partners.....                                                                                                                                                                                                                   |
| 23.0 Cookieless analytics integration                       | I think telemetry already covers this? I think we are storing cookies already, so maybe we give an option to disable them?                                                                                                                                                                                                                                                                                    |
| 24.0 Three engineering notes                                | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 24.1 Two systems diagrams                                   | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 24.2 PR review samples                                      | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 24.3 Incident templates                                     | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 25.0 Cross-browser/device QA matrix                         | I don't see the point. Mobile UI is basically an independent experience and will be checked for quality in isolation.                                                                                                                                                                                                                                                                                         |
| 25.1 Manual a11y audit                                      | Let's keep this one. We want some really decent accessibility practices.                                                                                                                                                                                                                                                                                                                                      |
| 26.0 SEO pass & sitemap                                     | Yeah this seems important. Let's prep for Search Engine indexing and make sure the site is displayed well in a search engine. I don't care about Twitter.                                                                                                                                                                                                                                                     |
| 26.1 Final perf hardening                                   | I don't see the point. Give me a good reason or delete. I'm going to try to do a security audit and ask my CyberSec friend for help.                                                                                                                                                                                                                                                                          |
| 26.2 Announcement + backup test                             | Not needed.                                                                                                                                                                                                                                                                                                                                                                                                   |
| 26.3 “Why an Onion Mirror” post                             | Throw this in the notes writeup. Refer to 13.0 Notes.                                                                                                                                                                                                                                                                                                                                                         |
